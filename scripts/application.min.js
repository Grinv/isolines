(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},q={}.hasOwnProperty,r=function(a,b){return function(){return a.apply(b,arguments)}};n=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},o=function(a,b){return n(0,8)*a+b},k=function(){function a(){var a;a=new Image,a.src=this.src,a.onload=function(a){return function(){return a.loaded=!0}}(this),this.image=a}return a.prototype.loaded=!1,a.prototype.src="images/sprite_sheet.png",a}(),j=function(){function a(a){this.game=a}return a.prototype.sx=0,a.prototype.sy=0,a.prototype.sw=0,a.prototype.sh=0,a.prototype.dx=0,a.prototype.dy=0,a.prototype.dw=0,a.prototype.dh=0,a.prototype.image=new k,a.prototype.drawImage=function(a,b,c,d){return this.image.loaded?this.game.ctx.drawImage(this.image.image,a,b,this.sw,this.sh,c,d,this.dw,this.dh):void 0},a}(),a=Zepto,a(function(){var a;return a=new e,a.run()}),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sx=192,b.prototype.sw=64,b.prototype.sh=64,b.prototype.dw=64,b.prototype.dh=64,b.prototype.draw=function(a,b){return this.drawImage(this.sx,this.sy,a,b)},b}(j),e=function(){function b(){this.update=r(this.update,this),this.ctx=this.createCanvas(),this.ballSprites.push(new f(this)),this.ballSprites.push(new i(this)),this.ballSprites.push(new h(this)),this.ballSprites.push(new m(this)),this.ballSprites.push(new d(this)),this.ballSprites.push(new c(this)),this.ballSprites.push(new l(this)),this.gridTile=new g(this),this.initBallsPosition()}return b.prototype.viewWidth=616,b.prototype.viewHeight=616,b.prototype.ballSprites=[],b.prototype.gridTile=null,b.prototype.fieldSize=9,b.prototype.field=[],b.prototype.createCanvas=function(){var b;return b=document.createElement("canvas"),b.width=this.viewWidth,b.height=this.viewHeight,a(".container .game").append(b),b.getContext("2d")},b.prototype.initBallsPosition=function(){var a,b,c,d,e,f,g,h;for(this.field=new Array(this.fieldSize),b=c=0,e=this.fieldSize;e>=0?e>c:c>e;b=e>=0?++c:--c)this.field[b]=new Array(this.fieldSize);for(g=[],b=d=0,f=Math.pow(this.fieldSize,2);f>=0?f>d:d>f;b=f>=0?++d:--d)a=b%this.fieldSize,h=b/this.fieldSize|0,g.push(this.field[h][a]=n(-1,6));return g},b.prototype.run=function(){return this.update()},b.prototype.update=function(){var a;return a=(new Date).getTime(),this.render(a-this.lastUpdate),this.lastUpdate=a,window.requestAnimationFrame(this.update)},b.prototype.render=function(a){return this.renderGrid(),this.renderBalls(),this.renderDebugOverlay(a)},b.prototype.renderDebugOverlay=function(a){var b;return this.ctx.fillStyle="#10161C",this.ctx.fillRect(0,0,80,20),b=Math.round(1e3/a)+" FPS",this.ctx.fillStyle="white",this.ctx.font="Bold 15px Helvetica",this.ctx.fillText(b,5,15)},b.prototype.renderGrid=function(){var a,b,c,d,e,f;for(d=[],a=b=0,c=Math.pow(this.fieldSize,2);c>=0?c>b:b>c;a=c>=0?++b:--b)e=a%this.fieldSize*64+20,f=64*(a/this.fieldSize|0)+20,d.push(this.gridTile.draw(e,f));return d},b.prototype.renderBalls=function(){var a,b,c,d,e,f,g,h;for(e=[],b=c=0,d=Math.pow(this.fieldSize,2);d>=0?d>c:c>d;b=d>=0?++c:--c)a=b%this.fieldSize,f=b/this.fieldSize|0,this.field[f][a]<0||(g=64*f+20,h=64*a+20,e.push(this.ballSprites[this.field[f][a]].draw(g,h)));return e},b}(),b=function(a){function b(a){b.__super__.constructor.call(this,a)}return p(b,a),b.prototype.sw=64,b.prototype.sh=64,b.prototype.dw=64,b.prototype.dh=64,b.prototype.draw=function(a,b){return this.dx=a,this.dy=b,this.drawImage(this.sx,this.sy,this.dx,this.dy)},b}(j),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b}(b),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sx=64,b}(b),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sx=128,b}(b),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sy=64,b}(b),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sy=64,b.prototype.sx=64,b}(b),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sy=64,b.prototype.sx=128,b}(b),l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.sy=64,b.prototype.sx=192,b}(b)}).call(this);